// This file was auto-generated by Fern from our API Definition.

import * as Schematic from "../../src/api/index";
import { SchematicClient } from "../../src/Client";
import { mockServerPool } from "../mock-server/MockServerPool";

describe("PlanbundleClient", () => {
    test("createPlanBundle (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new SchematicClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { entitlements: [{ action: "create" }] };
        const rawResponseBody = {
            data: {
                billing_product: {
                    account_id: "account_id",
                    billing_product_id: "billing_product_id",
                    charge_type: "free",
                    controlled_by: "schematic",
                    environment_id: "environment_id",
                    is_trialable: true,
                    monthly_price_id: "monthly_price_id",
                    one_time_price_id: "one_time_price_id",
                    plan_id: "plan_id",
                    trial_days: 1,
                    yearly_price_id: "yearly_price_id",
                },
                credit_grants: [
                    {
                        auto_topup_enabled: true,
                        created_at: "2024-01-15T09:30:00Z",
                        credit_amount: 1,
                        credit_id: "credit_id",
                        credit_name: "credit_name",
                        id: "id",
                        plan_id: "plan_id",
                        plan_name: "plan_name",
                        reset_cadence: "daily",
                        reset_start: "billing_period",
                        updated_at: "2024-01-15T09:30:00Z",
                    },
                ],
                entitlements: [
                    {
                        created_at: "2024-01-15T09:30:00Z",
                        environment_id: "environment_id",
                        feature_id: "feature_id",
                        id: "id",
                        plan_id: "plan_id",
                        rule_id: "rule_id",
                        updated_at: "2024-01-15T09:30:00Z",
                        value_type: "boolean",
                    },
                ],
                plan: {
                    created_at: "2024-01-15T09:30:00Z",
                    description: "description",
                    icon: "icon",
                    id: "id",
                    name: "name",
                    plan_type: "plan",
                    updated_at: "2024-01-15T09:30:00Z",
                },
                traits: [
                    {
                        account_id: "account_id",
                        created_at: "2024-01-15T09:30:00Z",
                        environment_id: "environment_id",
                        id: "id",
                        plan_id: "plan_id",
                        plan_type: "plan_type",
                        trait_id: "trait_id",
                        trait_value: "trait_value",
                        updated_at: "2024-01-15T09:30:00Z",
                    },
                ],
            },
            params: { key: "value" },
        };
        server
            .mockEndpoint()
            .post("/plan-bundles")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.planbundle.createPlanBundle({
            entitlements: [
                {
                    action: "create",
                },
            ],
        });
        expect(response).toEqual({
            data: {
                billingProduct: {
                    accountId: "account_id",
                    billingProductId: "billing_product_id",
                    chargeType: "free",
                    controlledBy: "schematic",
                    environmentId: "environment_id",
                    isTrialable: true,
                    monthlyPriceId: "monthly_price_id",
                    oneTimePriceId: "one_time_price_id",
                    planId: "plan_id",
                    trialDays: 1,
                    yearlyPriceId: "yearly_price_id",
                },
                creditGrants: [
                    {
                        autoTopupEnabled: true,
                        createdAt: new Date("2024-01-15T09:30:00.000Z"),
                        creditAmount: 1,
                        creditId: "credit_id",
                        creditName: "credit_name",
                        id: "id",
                        planId: "plan_id",
                        planName: "plan_name",
                        resetCadence: "daily",
                        resetStart: "billing_period",
                        updatedAt: new Date("2024-01-15T09:30:00.000Z"),
                    },
                ],
                entitlements: [
                    {
                        createdAt: new Date("2024-01-15T09:30:00.000Z"),
                        environmentId: "environment_id",
                        featureId: "feature_id",
                        id: "id",
                        planId: "plan_id",
                        ruleId: "rule_id",
                        updatedAt: new Date("2024-01-15T09:30:00.000Z"),
                        valueType: "boolean",
                    },
                ],
                plan: {
                    createdAt: new Date("2024-01-15T09:30:00.000Z"),
                    description: "description",
                    icon: "icon",
                    id: "id",
                    name: "name",
                    planType: "plan",
                    updatedAt: new Date("2024-01-15T09:30:00.000Z"),
                },
                traits: [
                    {
                        accountId: "account_id",
                        createdAt: new Date("2024-01-15T09:30:00.000Z"),
                        environmentId: "environment_id",
                        id: "id",
                        planId: "plan_id",
                        planType: "plan_type",
                        traitId: "trait_id",
                        traitValue: "trait_value",
                        updatedAt: new Date("2024-01-15T09:30:00.000Z"),
                    },
                ],
            },
            params: {
                key: "value",
            },
        });
    });

    test("createPlanBundle (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new SchematicClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { entitlements: [{ action: "create" }, { action: "create" }] };
        const rawResponseBody = { error: "error" };
        server
            .mockEndpoint()
            .post("/plan-bundles")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.planbundle.createPlanBundle({
                entitlements: [
                    {
                        action: "create",
                    },
                    {
                        action: "create",
                    },
                ],
            });
        }).rejects.toThrow(Schematic.BadRequestError);
    });

    test("createPlanBundle (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new SchematicClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { entitlements: [{ action: "create" }, { action: "create" }] };
        const rawResponseBody = { error: "error" };
        server
            .mockEndpoint()
            .post("/plan-bundles")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.planbundle.createPlanBundle({
                entitlements: [
                    {
                        action: "create",
                    },
                    {
                        action: "create",
                    },
                ],
            });
        }).rejects.toThrow(Schematic.UnauthorizedError);
    });

    test("createPlanBundle (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new SchematicClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { entitlements: [{ action: "create" }, { action: "create" }] };
        const rawResponseBody = { error: "error" };
        server
            .mockEndpoint()
            .post("/plan-bundles")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(403)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.planbundle.createPlanBundle({
                entitlements: [
                    {
                        action: "create",
                    },
                    {
                        action: "create",
                    },
                ],
            });
        }).rejects.toThrow(Schematic.ForbiddenError);
    });

    test("createPlanBundle (5)", async () => {
        const server = mockServerPool.createServer();
        const client = new SchematicClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { entitlements: [{ action: "create" }, { action: "create" }] };
        const rawResponseBody = { error: "error" };
        server
            .mockEndpoint()
            .post("/plan-bundles")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.planbundle.createPlanBundle({
                entitlements: [
                    {
                        action: "create",
                    },
                    {
                        action: "create",
                    },
                ],
            });
        }).rejects.toThrow(Schematic.NotFoundError);
    });

    test("createPlanBundle (6)", async () => {
        const server = mockServerPool.createServer();
        const client = new SchematicClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { entitlements: [{ action: "create" }, { action: "create" }] };
        const rawResponseBody = { error: "error" };
        server
            .mockEndpoint()
            .post("/plan-bundles")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(500)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.planbundle.createPlanBundle({
                entitlements: [
                    {
                        action: "create",
                    },
                    {
                        action: "create",
                    },
                ],
            });
        }).rejects.toThrow(Schematic.InternalServerError);
    });

    test("updatePlanBundle (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new SchematicClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { entitlements: [{ action: "create" }] };
        const rawResponseBody = {
            data: {
                billing_product: {
                    account_id: "account_id",
                    billing_product_id: "billing_product_id",
                    charge_type: "free",
                    controlled_by: "schematic",
                    environment_id: "environment_id",
                    is_trialable: true,
                    monthly_price_id: "monthly_price_id",
                    one_time_price_id: "one_time_price_id",
                    plan_id: "plan_id",
                    trial_days: 1,
                    yearly_price_id: "yearly_price_id",
                },
                credit_grants: [
                    {
                        auto_topup_enabled: true,
                        created_at: "2024-01-15T09:30:00Z",
                        credit_amount: 1,
                        credit_id: "credit_id",
                        credit_name: "credit_name",
                        id: "id",
                        plan_id: "plan_id",
                        plan_name: "plan_name",
                        reset_cadence: "daily",
                        reset_start: "billing_period",
                        updated_at: "2024-01-15T09:30:00Z",
                    },
                ],
                entitlements: [
                    {
                        created_at: "2024-01-15T09:30:00Z",
                        environment_id: "environment_id",
                        feature_id: "feature_id",
                        id: "id",
                        plan_id: "plan_id",
                        rule_id: "rule_id",
                        updated_at: "2024-01-15T09:30:00Z",
                        value_type: "boolean",
                    },
                ],
                plan: {
                    created_at: "2024-01-15T09:30:00Z",
                    description: "description",
                    icon: "icon",
                    id: "id",
                    name: "name",
                    plan_type: "plan",
                    updated_at: "2024-01-15T09:30:00Z",
                },
                traits: [
                    {
                        account_id: "account_id",
                        created_at: "2024-01-15T09:30:00Z",
                        environment_id: "environment_id",
                        id: "id",
                        plan_id: "plan_id",
                        plan_type: "plan_type",
                        trait_id: "trait_id",
                        trait_value: "trait_value",
                        updated_at: "2024-01-15T09:30:00Z",
                    },
                ],
            },
            params: { key: "value" },
        };
        server
            .mockEndpoint()
            .put("/plan-bundles/plan_bundle_id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.planbundle.updatePlanBundle("plan_bundle_id", {
            entitlements: [
                {
                    action: "create",
                },
            ],
        });
        expect(response).toEqual({
            data: {
                billingProduct: {
                    accountId: "account_id",
                    billingProductId: "billing_product_id",
                    chargeType: "free",
                    controlledBy: "schematic",
                    environmentId: "environment_id",
                    isTrialable: true,
                    monthlyPriceId: "monthly_price_id",
                    oneTimePriceId: "one_time_price_id",
                    planId: "plan_id",
                    trialDays: 1,
                    yearlyPriceId: "yearly_price_id",
                },
                creditGrants: [
                    {
                        autoTopupEnabled: true,
                        createdAt: new Date("2024-01-15T09:30:00.000Z"),
                        creditAmount: 1,
                        creditId: "credit_id",
                        creditName: "credit_name",
                        id: "id",
                        planId: "plan_id",
                        planName: "plan_name",
                        resetCadence: "daily",
                        resetStart: "billing_period",
                        updatedAt: new Date("2024-01-15T09:30:00.000Z"),
                    },
                ],
                entitlements: [
                    {
                        createdAt: new Date("2024-01-15T09:30:00.000Z"),
                        environmentId: "environment_id",
                        featureId: "feature_id",
                        id: "id",
                        planId: "plan_id",
                        ruleId: "rule_id",
                        updatedAt: new Date("2024-01-15T09:30:00.000Z"),
                        valueType: "boolean",
                    },
                ],
                plan: {
                    createdAt: new Date("2024-01-15T09:30:00.000Z"),
                    description: "description",
                    icon: "icon",
                    id: "id",
                    name: "name",
                    planType: "plan",
                    updatedAt: new Date("2024-01-15T09:30:00.000Z"),
                },
                traits: [
                    {
                        accountId: "account_id",
                        createdAt: new Date("2024-01-15T09:30:00.000Z"),
                        environmentId: "environment_id",
                        id: "id",
                        planId: "plan_id",
                        planType: "plan_type",
                        traitId: "trait_id",
                        traitValue: "trait_value",
                        updatedAt: new Date("2024-01-15T09:30:00.000Z"),
                    },
                ],
            },
            params: {
                key: "value",
            },
        });
    });

    test("updatePlanBundle (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new SchematicClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { entitlements: [{ action: "create" }, { action: "create" }] };
        const rawResponseBody = { error: "error" };
        server
            .mockEndpoint()
            .put("/plan-bundles/plan_bundle_id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.planbundle.updatePlanBundle("plan_bundle_id", {
                entitlements: [
                    {
                        action: "create",
                    },
                    {
                        action: "create",
                    },
                ],
            });
        }).rejects.toThrow(Schematic.BadRequestError);
    });

    test("updatePlanBundle (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new SchematicClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { entitlements: [{ action: "create" }, { action: "create" }] };
        const rawResponseBody = { error: "error" };
        server
            .mockEndpoint()
            .put("/plan-bundles/plan_bundle_id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.planbundle.updatePlanBundle("plan_bundle_id", {
                entitlements: [
                    {
                        action: "create",
                    },
                    {
                        action: "create",
                    },
                ],
            });
        }).rejects.toThrow(Schematic.UnauthorizedError);
    });

    test("updatePlanBundle (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new SchematicClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { entitlements: [{ action: "create" }, { action: "create" }] };
        const rawResponseBody = { error: "error" };
        server
            .mockEndpoint()
            .put("/plan-bundles/plan_bundle_id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(403)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.planbundle.updatePlanBundle("plan_bundle_id", {
                entitlements: [
                    {
                        action: "create",
                    },
                    {
                        action: "create",
                    },
                ],
            });
        }).rejects.toThrow(Schematic.ForbiddenError);
    });

    test("updatePlanBundle (5)", async () => {
        const server = mockServerPool.createServer();
        const client = new SchematicClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { entitlements: [{ action: "create" }, { action: "create" }] };
        const rawResponseBody = { error: "error" };
        server
            .mockEndpoint()
            .put("/plan-bundles/plan_bundle_id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.planbundle.updatePlanBundle("plan_bundle_id", {
                entitlements: [
                    {
                        action: "create",
                    },
                    {
                        action: "create",
                    },
                ],
            });
        }).rejects.toThrow(Schematic.NotFoundError);
    });

    test("updatePlanBundle (6)", async () => {
        const server = mockServerPool.createServer();
        const client = new SchematicClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { entitlements: [{ action: "create" }, { action: "create" }] };
        const rawResponseBody = { error: "error" };
        server
            .mockEndpoint()
            .put("/plan-bundles/plan_bundle_id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(500)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.planbundle.updatePlanBundle("plan_bundle_id", {
                entitlements: [
                    {
                        action: "create",
                    },
                    {
                        action: "create",
                    },
                ],
            });
        }).rejects.toThrow(Schematic.InternalServerError);
    });
});
